<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>專題網頁</title>
	<link rel="stylesheet" href="css/text.css" type="text/css">
    <style type="text/css">
		.container {margin: 100px auto;}
		.large_font {font-size: 24px;}
		.super_large_font {font-size: 40px;}
		.round_banner {border-radius: 20px;}
		.round_image {border-radius: 50%;}

	</style>

</head>
<body>

<div id="page">
<div id="header">
	<table align="center">
		<tr>
			<td height="150px"  align="right">
				<span><img width="140px" height="140px" src="img1.png"></span>
			</td>
			<td height="150px" align="center">
				<h1 id="logo"> <a href="index.html">智慧醫療麻醉深度之預測</a> </h1>
			</td>
			<td height="150px"  align="right">
				<span><img width="140px" height="140px" src="img2.png"></span>
			</td>
		</tr>
	</table>
	<div id="navigation">
		<ul class="drop-down-menu">
			<li class="large_font">
				<a href="index.html">首頁</a>
			</li>
			<li class="large_font">
				<a href="introduction.html">團隊介紹</a>
			</li>
			<li class="large_font">
				<a href="motivation.html">研究動機&目的</a>
			</li>
			<li class="large_font">
				<a href="description.html">背景說明</a>
			</li>
			<li class="large_font">
				<a href="description1.html">資料描述</a>
				<ul class="large_font">
					<li><a href="model01.html">模型一-----預測半身麻醉深度</a></li>
					<li><a href="model02.html">模型二-----預測麻醉後10分鐘的收縮壓</a></li>
					<li><a href="model03.html">模型三-----預測麻醉後10分鐘的舒張壓</a></li>
					<li><a href="model04.html">模型四-----預測麻醉後10分鐘的心跳變化</a></li>
					<li><a href="model05.html">模型五-----預測下刀後10分鐘的收縮壓</a></li>
					<li><a href="model06.html">模型六-----預測下刀後10分鐘的舒張壓</a></li>
					<li><a href="model07.html">模型七-----預測下刀後10分鐘的心跳變化</a></li>
					<li><a href="model08.html">模型八-----預測半身麻醉後是否使用升壓劑</a></li>
					<li><a href="model09.html">模型九-----預測半身麻醉後是否使用止痛藥</a></li>
				</ul>
			</li>
			<li class="large_font">
				<a href="process.html">研究過程</a>
					<ul class="large_font">
						<li><a href="employ.html">使用平台與套件</a></li>
						<li><a href="method.html">研究方法</a></li>
						<li><a href="steps.html">研究步驟</a></li>
					</ul>
			</li>
			<li>
				<a href="results.html" class="large_font">成果解說</a>
				<ul class="large_font">
					<li><a href="model1.html">模型一-----預測半身麻醉深度</a></li>
					<li><a href="model2.html">模型二-----預測麻醉後10分鐘的收縮壓</a></li>
					<li><a href="model3.html">模型三-----預測麻醉後10分鐘的舒張壓</a></li>
					<li><a href="model4.html">模型四-----預測麻醉後10分鐘的心跳變化</a></li>
					<li><a href="model5.html">模型五-----預測下刀後10分鐘的收縮壓</a></li>
					<li class="selected"><a href="model6.html">模型六-----預測下刀後10分鐘的舒張壓</a></li>
					<li><a href="model7.html">模型七-----預測下刀後10分鐘的心跳變化</a></li>
					<li><a href="model8.html">模型八-----預測半身麻醉後是否使用升壓劑</a></li>
					<li><a href="model9.html">模型九-----預測半身麻醉後是否使用止痛藥</a></li>
				</ul>
			</li>
			<li class="large_font">
				<a href="conclusion.html">結論</a>
			</li>
			<li class="large_font">
				<a href="reference.html">參考資料</a>
			</li>
			</ul>
		</div>
	</div>
</div>

<article>
<div id="body">
<h1>模型六<br>預測下刀後10分鐘的舒張壓</h1>
<p class="t1_font">
	<br>
	<br>
	<br>外科下刀後10分鐘的舒張壓
	<table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td>要預測的反應變數</td>
				<td>外科下刀10分鐘的舒張壓</td>
			</tr>
			<tr>
				<td>放入的解釋變數</td>
				<td align="LEFT">
					手術科別 (OBS婦產科、Ortho骨科、GU泌尿科、CRS大腸直腸外科)
				<br>病人麻醉風險等級(1-5)
				<br>是否為急診手術
				<br>年紀
				<br>身高
				<br>體重
				<br>身體質量指數
				<br>性別
				<br>理想體重計算
				<br>身體表面積
				<br>淨體重計算
				<br>術前是否高血壓病史
				<br>術前是否糖尿病病史
				<br>術前是否心律不整病史
				<br>術前是否懷孕
				<br>術前是否有僵直性脊椎炎
				<br>是否曾經接受腰椎手術
				<br>此次手術是否為痣瘡或肛門瘻管
				<br>腦脊椎液量之推測值
				<br>半身麻醉注射，使用Heavy或Plain marcaine
				<br>半身麻醉注射，marcaine使用劑量
				<br>半身麻醉注射，與marcaine混合之fentanyl劑量(若有)
				<br>半身麻醉注射部位
				<br>半身麻醉注射針之大小
				<br>半身麻醉注射針之針面方面
				<br>半身麻醉注射時之病人姿勢
				<br>半身麻醉施行醫師之年資，分四組(Above V10, V10-1, R4-3, R2-1)
				<br>半身麻醉完成後之麻醉高度測量
				<br>進入手術室的第一次收縮壓
				<br>進入手術室的第一次舒張壓
				<br>進入手術室的第一次心跳數
				<br>進入手術室的第一次血氧指數
				<br>外科下刀的收縮壓
				<br>外科下刀的舒張壓
				<br>外科下刀的心跳數
				<br>外科下刀的血氧指數
				<br>+特徵工程
				</td>
			</tr>
		</tbody>
	</table>
	<br>
	<br><b>Lasso篩選重要變數</b>
	<br>[1]女性x年齡取平方 x體重取平方
	<br>[2]女性x年齡取平方 x身體質量指數取平方
	<br>[3]病人麻醉風險等級3x術前有心律不整病史x 
	<br>半身麻醉注射，與marcaine混合之fentanyl劑量取平方
	<br>[4]病人麻醉風險等級3x術前有心律不整病史x
	<br>半身麻醉注射，與marcaine混合之fentanyl劑量取指數
	<br>[5]半身麻醉注射針大小為25Gx 女性x身體質量指數取平方
	<br>[6]半身麻醉注射針大小23G,25G,27G聯集x女性x身體質量指數取平方
	<br>[7]半身麻醉注射針之針面方面為Lateral,Head聯集x不是急診手術x理想體重計算取平方
	<br>[8]半身麻醉完成後之麻醉高度測量 
	<br>[9]進入手術室的第一次舒張壓  
	<br>[10]外科下刀的收縮壓
	<br>[11]外科下刀的舒張壓
	<br>
	<br>反應變數跟解釋變數的相關性
	<br>
	<table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td rowspan="2">外科下刀後十分鐘的舒張壓</td>
				<td>女性x年齡取平方 x體重取平方</td>
				<td>女性x年齡取平方 x身體質量指數取平方 </td>
				<td>病人麻醉風險等級3x術前有心律不整病史x半身麻醉注射，與marcaine混合之fentanyl劑量取平方 </td>
				<td>病人麻醉風險等級3x術前有心律不整病史x半身麻醉注射，與marcaine混合之fentanyl劑量取指數</td>
				<td>半身麻醉注射針大小為25Gx 女性x身體質量指數取平方  </td>
				<td>半身麻醉注射針大小23G,25G,27G聯集x女性x身體質量指數取平方    </td>
			</tr>
			<tr>
				<td>0.174674</td>
				<td>0.181536</td>
				<td>0.037568</td>
				<td>0.031057</td>
				<td>-0.171175</td>
				<td>-0.171175</td>
			</tr>
		</tbody>
	</table>	
	<table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td rowspan="2">外科下刀後十分鐘的舒張壓</td>
				<td>半身麻醉注射針之針面方面為Lateral,Head聯集x
				<br>不是急診手術x理想體重計算取平方</td>
				<td>半身麻醉完成後之麻醉高度測量</td>
				<td>進入手術室的第一次舒張壓</td>
				<td>外科下刀的收縮壓</td>
				<td>外科下刀的舒張壓</td>
			</tr>
			<tr>
				<td>0.148572823</td>
				<td>0.152210868</td>
				<td>0.388530254</td>
				<td>0.50458524</td>
				<td>0.68510028</td>
			</tr>
		</tbody>
	</table>
	<br>表(1)
	<br>&emsp;&emsp;可以從表(1)知道進入手術室的第一次舒張壓(解釋變數)、外科下刀的收縮
	<br>壓和外科下刀的舒張壓(解釋變數)與外科下刀後十分鐘的舒張壓(反應變數)相
	<br>關性較高，分別為0.388530254、0.50458524 和0.68510028 ，意思為進入手術
	<br>室的第一次舒張壓(解釋變數)、外科下刀的收縮壓和外科下刀的舒張壓(解釋變
	<br>數)為影響預測外科下刀後十分鐘的舒張壓(反應變數)的重要因子。
	<br>&emsp;&emsp;將Lasso篩選出來的變數放入XG、SVM、線性迴歸、GBM、Lightgbm、
	<br>stacking(線性迴歸+SVM+GBM)、模型疊加(線性迴歸+SVM+GBM)和模型疊加
	<br>(XG+GBM+Lightgbm)進行建模與預測，並計算預測值與真實值的差異(均方根誤差
	<br>RMSE)與計算真實值減預測值絕對值大於10占總比數(測試集)的多少%。
	<br>
	<br>註:RMSE=[方程式]，yi:真實值(測試集的外科下刀後十分鐘的心跳數值)，
	<br>yi-hat:預測值，n:測試集總數。
	<br>
	<table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td></td>
				<td>RMSE</td>
				<td>|真實值-預測值|>10的個數/測試集數量*100%</td>
				<td>真實值與預測值的散佈圖</td>
			</tr>
			<tr>
				<td>XG</td>
				<td>9.276991</td>
				<td>22.35%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/1.png"></td>
			</tr>
			<tr>
				<td>SVM</td>
				<td>8.449301</td>
				<td>18.13%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/2.png"></td>
			</tr>
			<tr>
				<td>線性迴歸</td>
				<td>8.378566</td>
				<td>19.04%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/3.png"></td>
			</tr>
			<tr>
				<td>GBM</td>
				<td>8.241654</td>
				<td>18.36%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/4.png"></td>
			</tr>
			<tr>
				<td>Lightgbm</td>
				<td>8.456383</td>
				<td>19.27%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/5.png"></td>
			</tr>
			<tr>
				<td>Stacking(線性迴歸+SVM+GBM)</td>
				<td>9.987108</td>
				<td>32.84%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/6.png"></td>
			</tr>
			<tr>
				<td>模型疊加(線性迴歸+SVM+GBM)</td>
				<td>8.265826</td>
				<td>17.9%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/7.png"></td>
			</tr>
			<tr>
				<td>模型疊加(XG+GBM+Lightgbm)</td>
				<td>8.434099</td>
				<td>19.27%</td>
				<td><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/8.png"></td>
			</tr>
		</tbody>
	</table>
	<br>表(2)
	<br>&emsp;&emsp;由表(2)的結果可以看出這八種模型以GBM為最佳分析方法，RMSE為
	<br>8.241654，且真實值減預測值絕對值大於10占總比數(測試集)的18.36%，也能
	<br>從散佈圖中看出真實值與預測值之間的關係，此分析方法做出的散佈圖，點更傾
	<br>向45度角延伸，表示預測出來的值跟真實值很接近，但還是有部分的點較為鬆
	<br>散，X軸與Y軸範圍沒有差很大，所以真實值與預測值的差異比預測外科下刀後
	<br>十分鐘的收縮壓來的小。
	<br>&emsp;&emsp;如何將最佳模型的RMSE降到更低與利用GBM建模是否穩定?
	<br>嘗試使用:
	<br>1.	解釋變數加入進入手術室的第一次舒張壓取平方和外科下刀的舒張壓取平方
	<br>2.	交叉驗證
	<br>
	<br>
	<table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td></td>
				<td>進入手術室的第一次舒張壓</td>
				<td>進入手術室的第一次舒張壓做平方</td>
			</tr>
			<tr align="left">
				<td rowspan="5">
						外
					<br>科
					<br>下
					<br>刀
					<br>後
					<br>十
					<br>分
					<br>鐘
					<br>的
					<br>舒
					<br>張
					<br>壓
				</td>
				<td>相關係數: 0.3885303
				<br>散佈圖:
				<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/9.png">
				</td>
				<td>相關係數: 0.3855643
				<br>散佈圖:
				<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/10.png">
				</td>
			</tr>
			<tr>
				<td>外科下刀的舒張壓</td>
				<td>外科下刀的舒張壓做平方</td>
			</tr>
			<tr align="left">
				<td>相關係數: 0.6851003
				<br>散佈圖:
				<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/11.png">
				</td>
				<td>相關係數: 0.6768159
				<br>散佈圖:
				<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/12.png">
				</td>
			</tr>
		</tbody>
	</table>
	<br>表(3)
	<br>&emsp;&emsp;從表(3)呈現出來的結果，決定解釋變數加入進入手術室的第一次舒張壓取
	<br>平方和外科下刀的舒張壓取平方，因為將他們取平方之後與原本的相關係數與圖
	<br>形沒有太大的差異，所以可能為預測外科下刀後十分鐘的舒張壓重要因子。
	<br>
	<br><b>Lasso篩選重要變數</b>
	<br>(解釋變數加入進入手術室的第一次舒張壓取平方和外科下刀的舒張壓取平方重新篩選)
	<br>[1]女性x年齡取平方 x體重取平方
	<br>[2]女性x年齡取平方 x身體質量指數取平方
	<br>[3]病人麻醉風險等級3x術前有心律不整病史x
	<br>半身麻醉注射，與marcaine混合之fentanyl劑量取平方 
	<br>[4] 病人麻醉風險等級3x術前有心律不整病史x
	<br>半身麻醉注射，與marcaine混合之fentanyl劑量取指數
	<br>[5] 半身麻醉注射針大小為25Gx 女性x身體質量指數取平方
	<br>[6] 半身麻醉注射針大小23G,25G,27G聯集x女性x身體質量指數取平方
	<br>[7] 半身麻醉注射針之針面方面為Lateral,Head聯集x不是急診手術x理想體重計算取平方
	<br>[8]半身麻醉完成後之麻醉高度測量 
	<br>[9]進入手術室的第一次舒張壓
	<br>[10]外科下刀的收縮壓  
	<br>[11]外科下刀的舒張壓
	<br>
	<br>&emsp;&emsp;重新篩選之後發現未篩選出進入手術室的第一次舒張壓取平方和外科下刀
	<br>的舒張壓取平方，也與原本篩選出一模一樣的變數，所以將原本的最佳模型(GBM
	<br>模型)做交叉驗證，放入自製的for迴圈當中，讓程式反覆執行一百次，並得出
	<br>一百個結果(RMSE的值)，然後取平均，勘查模型是否穩定並比較沒有使用交叉
	<br>驗證和有使用交叉驗證預測出來的結果。
	<br>
	<br>GBM
	<br><table border="1" cellspacing="2" cellpadding="6" align="center">
		<tbody align="center">
			<tr>
				<td></td>
				<td>RMSE</td>
				<td>|真實值-預測值|>10的個數/測試集數量*100%</td>
			</tr>
			<tr>
				<td>外科下刀的10分鐘的舒張壓</td>
				<td>8.241654</td>
				<td>18.36%</td>
			</tr>
			<tr>
				<td>外科下刀的10分鐘的舒張壓(交叉驗證)</td>
				<td>8.577417</td>
				<td>20.05%</td>
			</tr>
		</tbody>
	</table>
	<br>表(4)
	<br>
	<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/13.png">
	<br>圖一、一百次的RMSE結果圖
	<br><img src="C:/Users/user/Desktop/成果複稿/網頁/images/m6-img/14.png">
	<br>圖二、一百次的真實值減預測值大於十占比結果圖
	<br>
	<br>&emsp;&emsp;從表(4)可以看出沒有做交叉驗證得來的比有做交叉驗證來的好，也可以從
	<br>圖一圖二得知，做了一百的交叉驗證中有些預測出來的值與真實值相差較大，所
	<br>以平均之後拉低了RMSE的值與提高了真實值減掉預測值絕對值大於十的占比，
	<br>並可以從圖一看出利用GBM模型預測一百次的RMSE大致落在8.5左右，只有少
	<br>數預測出來的值比較突兀，所以利用GBM模型預測是穩定的。
	<br>
	<br>
	<br>
	<br>
	<br>
	
</p>
</div>
</article>
	
	
<footer>
	<div id="footer">
		<div id="Main">
			<div class="background">
				<div class="body">
					<p style="text-align: center;">
						<span style="color: purple;font-size: 24px;">&#9734;</span>
						<span style="color: orange;font-size: 24px;"><b>資料科學</b></span>
						<span style="color: black;font-size: 24px;">幫助人類，</span>
						<span style="color: orange;font-size: 24px;"><b>人工智慧</b></span>
						<span style="color: black;font-size: 24px;">創新世界</span>
						<span style="color: purple;font-size: 24px;">&#9734;</span>
					</p>
					<div id="section1">
						<table align="center" width="600px">
							<tr>
								<td>
									<p>靜宜大學<br>Providence University</p>
									<p>43301臺中市沙鹿區臺灣大道7段200號<br>
										200, Sec. 7, Taiwan Boulevard, Shalu Dist.,<br>
										Taichung City 43301 Taiwan
									</p>
								</td>
								<td>
									<p>靜宜大學<br>資料科學暨大數據分析與應用學系<br>PUDS</p>
									<p>電 話：886-4 26328001<br>#15051,15052,15053<br>
										傳 真：(04) 2631-4846<br>
										信 箱：pu20250@pu.edu.tw
									</p>
								</td>
							</tr>
						</table>
					</div>

				</div>
			</div>
		</div>
	</div>
</footer>






</body>
</html>